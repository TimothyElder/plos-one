<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PONE-D-10-05828</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0017817</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Evolutionary biology</subject>
            <subj-group>
              <subject>Animal behavior</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Zoology</subject>
            <subj-group>
              <subject>Animal behavior</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Social and behavioral sciences</subject>
          <subj-group>
            <subject>Anthropology</subject>
            <subj-group>
              <subject>Biological anthropology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sociology</subject>
            <subj-group>
              <subject>Social networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Neuroscience</subject>
          <subject>Evolutionary Biology</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Ranking Network of a Captive Rhesus Macaque Society: A Sophisticated Corporative Kingdom</article-title><alt-title alt-title-type="running-head">Ranking Network of Captive Rhesus Macaques</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Fushing</surname>
            <given-names>Hsieh</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>McAssey</surname>
            <given-names>Michael P.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Beisner</surname>
            <given-names>Brianne</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>McCowan</surname>
            <given-names>Brenda</given-names>
          </name>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Statistics, University of California Davis, Davis, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Statistics, University of California Davis, Davis, California, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>California National Primate Research Center, University of California Davis, Davis, California, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>California National Primate Research Center, Department of Population Health and Reproduction, School of Veterinary Medicine, University of California Davis, Davis, California, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Perc</surname>
            <given-names>Matjaz</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Maribor, Slovenia</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">bjmccowan@ucdavis.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: BM BB HF MPA. Performed the experiments: BM BB HF MPA. Analyzed the data: HF MPA. Contributed reagents/materials/analysis tools: BM BB HF MPA. Wrote the manuscript: HF MPA BB BM.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>15</day>
        <month>3</month>
        <year>2011</year>
      </pub-date><volume>6</volume><issue>3</issue><elocation-id>e17817</elocation-id><history>
        <date date-type="received">
          <day>2</day>
          <month>12</month>
          <year>2010</year>
        </date>
        <date date-type="accepted">
          <day>10</day>
          <month>2</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Fushing et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>We develop a three-step computing approach to explore a hierarchical ranking network for a society of captive rhesus macaques. The computed network is sufficiently informative to address the question: Is the ranking network for a rhesus macaque society more like a kingdom or a corporation? Our computations are based on a three-step approach. These steps are devised to deal with the tremendous challenges stemming from the transitivity of dominance as a necessary constraint on the ranking relations among all individual macaques, and the very high sampling heterogeneity in the behavioral conflict data. The first step simultaneously infers the ranking potentials among all network members, which requires accommodation of heterogeneous measurement error inherent in behavioral data. Our second step estimates the social rank for all individuals by minimizing the network-wide errors in the ranking potentials. The third step provides a way to compute confidence bounds for selected empirical features in the social ranking. We apply this approach to two sets of conflict data pertaining to two captive societies of adult rhesus macaques. The resultant ranking network for each society is found to be a sophisticated mixture of both a kingdom and a corporation. Also, for validation purposes, we reanalyze conflict data from twenty longhorn sheep and demonstrate that our three-step approach is capable of correctly computing a ranking network by eliminating all ranking error.</p>
      </abstract><funding-group><funding-statement>The first two authors are supported in part by the NSF under Grant No. HSD 0826844 and DMS-1007219, and by the NIH under Grant No. 1R01AG025218-01A2. The last two authors are supported in part by the NIH under Grant Nos. R24 RR024396 (BM) and PR51 RR000169 (CNPRC Base Grant). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="9"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>In many animal societies, individual members are understood to possess an intrinsic characteristic called <italic>dominance</italic> which both regulates and is molded by their interactions with other members <xref ref-type="bibr" rid="pone.0017817-Drews1">[1]</xref>. Dominance hierarchies are thus a common feature of many such societies, ranging from wasps <xref ref-type="bibr" rid="pone.0017817-Bonabeau1">[2]</xref> to crayfish <xref ref-type="bibr" rid="pone.0017817-Goessmann1">[3]</xref> to pigeons <xref ref-type="bibr" rid="pone.0017817-Nagy1">[4]</xref> to longhorn sheep <xref ref-type="bibr" rid="pone.0017817-Hass1">[5]</xref>, <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>. Furthermore, animal societies have typically been placed into one of two categories: those with defined dominance relationships and those with undefined, or egalitarian, relationships, e.g., <xref ref-type="bibr" rid="pone.0017817-Isbell1">[7]</xref>. In social groups with detectable dominance relationships, group members are usually arranged into a sequential (often called <italic>linear</italic>) hierarchy based upon observations of direct conflicts between group members. In a sequential hierarchy, the top-ranked member of the group dominates all other members, the second-ranked member dominates all other members except the top-ranked member, and so on. An abundance of mathematical methods have been presented to determine the sequential hierarchy in animal societies based on observed interactions among their members, e.g., <xref ref-type="bibr" rid="pone.0017817-Bonabeau1">[2]</xref>, <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>, <xref ref-type="bibr" rid="pone.0017817-Hemelrijk1">[8]</xref>, <xref ref-type="bibr" rid="pone.0017817-DeVries1">[9]</xref>.</p>
      <p>However, in some social groups the dominance hierarchy may not follow a completely sequential pattern, particularly in larger groups and those with highly complex social and cognitive abilities. In addition, the social hierarchy may exist along a continuum between a sequential dominance hierarchy and an egalitarian society where some group members have clear dominance relationships while others do not <xref ref-type="bibr" rid="pone.0017817-Bonabeau1">[2]</xref>, <xref ref-type="bibr" rid="pone.0017817-DeVries1">[9]</xref>. Therefore, alternative methods for analyzing the ranking structure of social groups must be sought.</p>
      <p>A common example of a non-sequential network is the corporative one. A corporative ranking network allows several groups of individuals to have no dominance relations among them. Typically such a network consists of several tiers: one “governing” group sitting on the top tier, and multiple lower tiers, each of which may contain several parallel groups. Sequential dominance relationships are only found among individuals within the same group and among groups with a group-dominance relation. This ranking network is common in human society, but has rarely been studied using social network analysis <xref ref-type="bibr" rid="pone.0017817-Wasserman1">[10]</xref>. An illustrative network is given in panel (a) of <xref ref-type="fig" rid="pone-0017817-g001">Figure 1</xref>. A special case of a corporative ranking network is the kingdom ranking network, in which each group is identified by a common biological linkage, such as matriline or common genetic descent. In particular, the “governing” group is the so-called “royal” group, and royal group members are absolutely not dominated by any non-royal group member in the society.</p>
      <fig id="pone-0017817-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0017817.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>An illustrative matrix representation of an ideal corporative ranking structure.</title>
          <p>Panel (a) depicts a hierarchy of four tiers with eight groups. Groups on the same tier have the same rank, Panel (b) shows an upper-triangular matrix consisting mostly of 1 s, with several rectangular patches consisting of 0 s (represented by dots), representing the presence or absence of pairwise dominance relationships among the members of the eight groups.</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.g001" xlink:type="simple"/>
      </fig>
      <p>A distinctive feature of a non-sequential ranking network in general is that transitivity, by which a dominance relationship between two individuals may be inferred based upon their observed interactions with a common third party, plays a more influential role than that in a sequential ranking network. For instance, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e001" xlink:type="simple"/></inline-formula> dominates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e002" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e003" xlink:type="simple"/></inline-formula> dominates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e004" xlink:type="simple"/></inline-formula>, then it is inferred that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e005" xlink:type="simple"/></inline-formula> dominates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e006" xlink:type="simple"/></inline-formula>. With <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e007" xlink:type="simple"/></inline-formula> as an intermediate individual, the dominance relationship between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e008" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e009" xlink:type="simple"/></inline-formula> can hold even without observation of direct interactions between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e011" xlink:type="simple"/></inline-formula>. Thus, in a corporative ranking network, many network parameters, such as dominance potentials, are highly interdependent and interact in a non-sequential fashion. The task of constructing such a complex network, therefore, becomes computationally challenging.</p>
      <p>The pertinent challenge can be perceived from two successive levels: The first level involves simultaneous inference of all possible dominance potentials among network members from observed behavioral interactions. These behavioral data involve pairs of network members with and without observed direct interaction, and thus the task of estimating the dominance potentials of all possible pairs is subject to highly heterogeneous measurement error. The second level involves identifying each individual's network coordinate, by arranging all pairwise dominance potentials into an upper-triangular matrix form similar to the illustrating example presented in <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(b)</xref>.</p>
      <p>In the matrix shown in <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(b)</xref>, a 1 in cell <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e012" xlink:type="simple"/></inline-formula> indicates that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e013" xlink:type="simple"/></inline-formula>th individual dominates the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e014" xlink:type="simple"/></inline-formula>th individual in the society, while a dot indicates otherwise. The rows (and columns) are arranged in such a way that the first four correspond to the members of group <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e015" xlink:type="simple"/></inline-formula> at the top of the structure shown in panel (a) of <xref ref-type="fig" rid="pone-0017817-g001">Figure 1</xref>, followed by four rows corresponding to the members of group <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e016" xlink:type="simple"/></inline-formula>, then group <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e017" xlink:type="simple"/></inline-formula>, and so on, with the final four rows corresponding to the members of group <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e018" xlink:type="simple"/></inline-formula>. The rectangular patches of dots within the upper triangle occur because the pairwise dominance between members of different groups occupying the same tier of the hierarchy, such as groups <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e019" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e021" xlink:type="simple"/></inline-formula>, cannot be distinguished. However, within any group the members may follow a dominance order, which is indicated by the consecutive small triangular clusters of 1 s along the diagonal of the matrix. The absence of 1 s in the lower triangle shows that a permutation of the members of this society has been identified such that, if the members are assigned ranks in this order, then no individual of lower rank dominates any individual of higher rank.</p>
      <p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e022" xlink:type="simple"/></inline-formula> denote the dominance potential of group member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e023" xlink:type="simple"/></inline-formula> over member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e024" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e025" xlink:type="simple"/></inline-formula>. Then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e026" xlink:type="simple"/></inline-formula> dominates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e027" xlink:type="simple"/></inline-formula> if and only if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e028" xlink:type="simple"/></inline-formula>. Hence, given a matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e029" xlink:type="simple"/></inline-formula> with the rows and columns to be ordered by rank, the goal is to find a permutation of all individuals in the society such that the sum of the dominance potentials exceeding 0.5 in the lower triangle of the matrix are as small as possible. The individual ranks of each network member must be simultaneously estimated based on both direct observation of dominance behavior and inferred dominance due to the assumed transitivity. Thus the challenge becomes a high-dimensional mathematical optimization problem subject to heterogeneous uncertainty. Moreover, since in a non-sequential ranking network many pairs will have dominance potentials near 0.5, more than one set of ranking coordinates can produce a legitimate optimal solution.</p>
      <p>The fact that non-sequential ranking network structure has not yet been well-studied in the literature is partly due to the unavailability of reliable data. However, the availability of reliable data has changed dramatically in the past two decades as the awareness of social network theory, aided by information advances, has motivated researchers to collect network-like data, especially in animal behavioral studies. Reliable behavioral data sets of non-human primate societies are available from many institutes across many research fields, such as the California National Primate Research Center (CNPRC).</p>
      <p>In this paper we resolve the aforementioned challenges computationally. Three steps are devised. The first step simultaneously estimates all dominance potentials based on both direct pairwise interactions and transitive dominance inferred from interactions with common third parties. Our second step estimates the ranking coordinates of all individuals by minimizing the cumulative error in the inferred dominance potentials across the entire network. The third step derives confidence bounds for desired empirical features of the computed ranking network by accommodating heterogeneous measurement error.</p>
      <p>In addition to its ability to accommodate non-sequential ranking structures, our three-step approach provides advantages not found in other existing mathematical approaches. In our first step, we enhance the initial estimate of the dominance potential, which is based only on direct pairwise interactions, by further incorporating information gained through the assumption of dominance transitivity. By converting from the estimated probabilities to odds and adjusting the odds based on interactions with third parties, we are able to accommodate apparent inconsistencies among the data, such as when member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e030" xlink:type="simple"/></inline-formula> usually wins its conflicts with member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e031" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e032" xlink:type="simple"/></inline-formula> usually wins its conflicts with member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e033" xlink:type="simple"/></inline-formula>, but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e034" xlink:type="simple"/></inline-formula> usually wins its conflicts with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e035" xlink:type="simple"/></inline-formula> (see <xref ref-type="bibr" rid="pone.0017817-DeVries1">[9]</xref>). In such cases, the estimated dominance potentials among the three individuals, after converting back from odds, will rightly tend to be closer to 0.5 than they would be had transitivity been neglected. Moreover, in our third step, we take into account the uncertainty in the data in order to provide a measure of precision for our rank estimates. An individual that consistently wins in many conflicts with individual <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e036" xlink:type="simple"/></inline-formula> and consistently loses in many conflicts with member <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e037" xlink:type="simple"/></inline-formula> should almost certainly be assigned a rank between the ranks of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e038" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e039" xlink:type="simple"/></inline-formula>. But for many individuals there are few observed conflicts with the other members, and the outcomes of those few conflicts may vary from one occasion to the next. In such cases the ranking coordinates are less certain. This uncertainty is quantified under our approach using repeated samples from a posterior probability distribution, so that confidence bounds for the ranks of individuals may be established. We are unaware of any other method that accounts for the uncertainty in this manner.</p>
      <p>In an attempt to validate our proposed three-step approach and at the same time make a comparison with a result based on Bayesian analysis <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>, we reanalyze a data set of twenty longhorn sheep from <xref ref-type="bibr" rid="pone.0017817-Hass1">[5]</xref>. We show our steps are capable of computing a set of “perfect” non-sequential ranking networks, in which our estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e040" xlink:type="simple"/></inline-formula> contains no values in the lower triangle exceeding 0.5. The existence of such a set is primarily due to the fact that there are two sheep that have no direct interactions with most of the dominant sheep, but have a couple of wins over lower-ranking sheep. Therefore they can be placed at several different ranking network coordinates without affecting the non-sequential ranking network. This perspective of a ranking network is nearly impossible for a purely sequential ranking model based on Bayesian analysis, even for a relatively small society.</p>
      <p>We apply our three-step approach to sets of conflict data, collected at CNPRC, by first establishing a ranking network for 94 adult rhesus macaques (mean total group size = 137 adults, juveniles, and infants) living in a half-acre outdoor captive enclosure. The resultant ranking network is coupled with known matriline information. We then apply our approach to conflict data collected from a second colony of macaques to compute the ranking network and confirm the utility of this methodology. In this fashion we address the question: Is the rhesus macaque's society organized as a purely corporative ranking network, a kingdom version of a corporative network, or a mixture of these? The characterization of rhesus macaque society in terms of corporative or kingdom ranking networks may also shed light on how such hierarchical networks are maintained through lower-level interactions among individuals and groups of individuals (such as matrilines).</p>
    </sec>
    <sec id="s2" sec-type="methods">
      <title>Methods</title>
      <sec id="s2a">
        <title>Ethics statement</title>
        <p>All research reported in this manuscript adhered to the recommendations in the Guide for the Care and Use of Laboratory Animals of the National Institutes of Health, the laws of the United States government, and the recommendations of the Weatherall report, “The use of non-human primates in research.” All research subjects were housed in large social groups in half-acre outdoor enclosures to provide for their psychological well-being. The methodological approach was purely observational, and involved no experimental or invasive treatment of the animals. All occurrences of illness or injury among study subjects were immediately reported to and treated by CNPRC veterinary staff, and all efforts were made to ameliorate suffering. This project was approved by the University of California, Davis Institutional Animal Care and Use Committee, protocol #11843.</p>
        <p>Consider a single enclosure with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e041" xlink:type="simple"/></inline-formula> adult rhesus macaques indexed by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e042" xlink:type="simple"/></inline-formula> from 1 through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e043" xlink:type="simple"/></inline-formula>. For any <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e044" xlink:type="simple"/></inline-formula> pair of macaques, we want to infer the unknown probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e045" xlink:type="simple"/></inline-formula> that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e046" xlink:type="simple"/></inline-formula>th macaque dominates the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e047" xlink:type="simple"/></inline-formula>th macaque, as well as the reverse dominance probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e048" xlink:type="simple"/></inline-formula>. The inference for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e049" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e050" xlink:type="simple"/></inline-formula> is based on the behavioral records <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e051" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e052" xlink:type="simple"/></inline-formula>, which count the numbers of observed wins for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e053" xlink:type="simple"/></inline-formula>th macaque over the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e054" xlink:type="simple"/></inline-formula>th macaque, and vice versa, among their total number <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e055" xlink:type="simple"/></inline-formula> of observed direct conflicts.</p>
        <p>Due to the weekly behavioral sampling scheme (6 hrs/day, 4 days/week; see <xref ref-type="bibr" rid="pone.0017817-Beisner1">[11]</xref>, in press, for a complete description of observational methods), it is not uncommon to find severe heterogeneity in the collection of data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e056" xlink:type="simple"/></inline-formula>. In a cage consisting of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e057" xlink:type="simple"/></inline-formula> mature macaques, the total possible number of pairwise interactions within the social group is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e058" xlink:type="simple"/></inline-formula>. But only a small percentage of pairs were observed to have any direct interaction, and the remaining pairs were never observed to interact. Hence, under modeling with Bernoulli random variables, the unknown parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e059" xlink:type="simple"/></inline-formula> would be estimated with very high heterogeneous precision for those cases of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e060" xlink:type="simple"/></inline-formula>. However, their estimated dominance probabilities may differ significantly from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e061" xlink:type="simple"/></inline-formula>, because of the transitivity property. Thus, the collection of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e062" xlink:type="simple"/></inline-formula> parameters are dependent upon one another in a non-sequential fashion, and not orthogonally, as is often assumed. The parameter space, where the “true” parameters live, is indeed a very complex manifold.</p>
        <p>Given the non-sequential interdependence among the collection of parameters in such a network, the likelihood-based approaches, including maximum likelihood and Bayesian analysis, are inappropriate for proper inference on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e063" xlink:type="simple"/></inline-formula> parameters, simply because the optimization task upon a nearly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e064" xlink:type="simple"/></inline-formula>-dimensional complex manifold is practically impossible. A glimpse of such difficulty can be seen in the Bayesian analysis reported in <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>. Even when ignoring the interdependence among the parameters, the high dimensionality alone, despite the small group size of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e065" xlink:type="simple"/></inline-formula>, causes the posterior density to be too flat to be of practical use.</p>
        <p>The first task in computing a non-sequential ranking network is to simultaneously calculate the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e066" xlink:type="simple"/></inline-formula> dominance potential parameters for all possible pairwise interactions among network members. Since many of these pairs have no observed direct interactions, the dominance potential parameters must be inferred from the transitivity relationships among the parameters. These features create very high dimensionality in the parameter space and result in high heterogeneity of precision in parameter estimation. We address this task in the first subsection.</p>
        <p>After estimating the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e067" xlink:type="simple"/></inline-formula> parameters, the next challenging task is to construct a non-sequential ranking network. This task is analogous to working out a puzzle with many irregularly-shaped pieces and many missing pieces. We accomplish this in the second subsection by transforming the network construction task into an optimization problem, and then developing an approach equipped with Simulated Annealing <xref ref-type="bibr" rid="pone.0017817-Kirkpatrick1">[12]</xref> to resolve this fundamental construction. Finally, we present a third step in the third subsection in which we derive a basis for empirical confidence bounds for features observed in the computed ranking network.</p>
      </sec>
      <sec id="s2b">
        <title>The first step: S1</title>
        <p>Given the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e068" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e069" xlink:type="simple"/></inline-formula> of behavior records for each pair of macaques, we construct four new <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e070" xlink:type="simple"/></inline-formula> matrices. Matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e071" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e072" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e073" xlink:type="simple"/></inline-formula>, gives the empirical odds that macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e074" xlink:type="simple"/></inline-formula> dominates macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e075" xlink:type="simple"/></inline-formula>, based on observed confrontations between the two. We add one to each record to avoid division by zero. Then matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e076" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e077" xlink:type="simple"/></inline-formula>, gives the empirical probability that macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e078" xlink:type="simple"/></inline-formula> dominates macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e079" xlink:type="simple"/></inline-formula> based solely on direct observations of conflicts. The computed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e080" xlink:type="simple"/></inline-formula> serve as initial estimates of the unknown probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e081" xlink:type="simple"/></inline-formula>, which are the true pairwise dominance probabilities.</p>
        <p>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e082" xlink:type="simple"/></inline-formula> may be regarded as the posterior mean of a beta distribution with parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e083" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e084" xlink:type="simple"/></inline-formula>. That is, given a uniform prior distribution for the unknown probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e085" xlink:type="simple"/></inline-formula> and a binomial distribution for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e086" xlink:type="simple"/></inline-formula> (with parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e088" xlink:type="simple"/></inline-formula>), the posterior distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e089" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e090" xlink:type="simple"/></inline-formula> is the Beta <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e091" xlink:type="simple"/></inline-formula> with mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e092" xlink:type="simple"/></inline-formula>. This idea will be exploited in step S3.</p>
        <p>From <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e093" xlink:type="simple"/></inline-formula> we construct the transitivity structure matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e094" xlink:type="simple"/></inline-formula> such that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.e095" xlink:type="simple"/></disp-formula>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e096" xlink:type="simple"/></inline-formula> signifies the dominance odds between macaques <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e098" xlink:type="simple"/></inline-formula> based solely on transitivity implied by their interactions with other single intermediate macaques. Note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e099" xlink:type="simple"/></inline-formula> is never less than one. In order for the ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e100" xlink:type="simple"/></inline-formula> to exceed one, the observed dominances of macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e101" xlink:type="simple"/></inline-formula> over intermediate macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e102" xlink:type="simple"/></inline-formula> and of macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e103" xlink:type="simple"/></inline-formula> over macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e104" xlink:type="simple"/></inline-formula> must both be strong enough to make the product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e105" xlink:type="simple"/></inline-formula> exceed 0.5. Hence the dominance of macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e106" xlink:type="simple"/></inline-formula> over macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e107" xlink:type="simple"/></inline-formula> via transitivity is implied conservatively. The matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e108" xlink:type="simple"/></inline-formula> thus carries information about the dependence network structure embedded in the data.</p>
        <p>Finally, we construct the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e109" xlink:type="simple"/></inline-formula> by first setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e110" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e111" xlink:type="simple"/></inline-formula>, then setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e112" xlink:type="simple"/></inline-formula> to standardize. This standardization makes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e113" xlink:type="simple"/></inline-formula>. The matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e114" xlink:type="simple"/></inline-formula> thus gives the odds that macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e115" xlink:type="simple"/></inline-formula> dominates macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e116" xlink:type="simple"/></inline-formula>, implied by both observation of direct conflicts between them and by the transitivity relations among the other macaques. Step S1 outputs both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e117" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e118" xlink:type="simple"/></inline-formula> for use in the next two steps.</p>
      </sec>
      <sec id="s2c">
        <title>The second step: S2</title>
        <p>The second step estimates the rank of each macaque in the social hierarchy based on the dominance odds computed in step S1. This is accomplished by first computing an initial ranking using the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e119" xlink:type="simple"/></inline-formula> obtained in S1, then using the simulated annealing algorithm to improve upon this ranking by minimizing a cost function.</p>
        <p>Based on the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e120" xlink:type="simple"/></inline-formula> matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e121" xlink:type="simple"/></inline-formula> from S1, with elements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e122" xlink:type="simple"/></inline-formula>, we construct the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e123" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e124" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e125" xlink:type="simple"/></inline-formula>. This converts the odds into enhanced probabilities. These probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e126" xlink:type="simple"/></inline-formula> differ from the probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e127" xlink:type="simple"/></inline-formula> computed directly from the observed pairwise conflicts, since the dominance probability implied by transitivity has been incorporated into their computations. We then choose a threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e128" xlink:type="simple"/></inline-formula> and construct the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e129" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e130" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e131" xlink:type="simple"/></inline-formula> and equals zero otherwise. In practice we use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e132" xlink:type="simple"/></inline-formula>. We seek to rearrange the columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e133" xlink:type="simple"/></inline-formula> such that the upper triangle contains few zeros and the lower triangle contains many zeros. To accomplish this, we compute the sum of each column, then order the columns such that the sums of the columns are nondecreasing from left to right. We then rearrange the rows and columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e134" xlink:type="simple"/></inline-formula> according to the same order. The purpose of this effort is to minimize the sum of those values in the lower triangle of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e135" xlink:type="simple"/></inline-formula> exceeding 0.5. The values in the lower triangle represent the estimated probabilities that lower-ranking macaques dominate higher-ranking macaques, which would not exceed 0.5 in the ideal situation. This technique produces the initial estimate of the macaque ranking order, which is not necessarily optimal.</p>
        <p>To determine the quality of the estimated ranking order, we devise a cost function whose argument is the lower diagonal entries of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e136" xlink:type="simple"/></inline-formula>. We construct this function so that values greater than 0.5 in the lower diagonal will be penalized, with the penalty increasing at a greater rate as the values approach one. While other definitions are plausible, the cost function used here is defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.e137" xlink:type="simple"/><label>(1)</label></disp-formula>As <xref ref-type="fig" rid="pone-0017817-g002">Figure 2</xref> shows, for each element <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e138" xlink:type="simple"/></inline-formula> in the lower triangle of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e139" xlink:type="simple"/></inline-formula>, this function adds cost equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e140" xlink:type="simple"/></inline-formula> whenever <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e141" xlink:type="simple"/></inline-formula>, with the cost increasing steeply as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e142" xlink:type="simple"/></inline-formula> approaches one. In the ideal situation, no element in the lower triangle of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e143" xlink:type="simple"/></inline-formula> exceeds 0.5, and thus the cost is zero. But observations of conflict behavior in a complex society may not allow the computation of an optimal cost near zero. The simulated annealing (SA) algorithm <xref ref-type="bibr" rid="pone.0017817-Kirkpatrick1">[12]</xref> is implemented to seek an optimal ranking order that will provide a total cost which is as close to zero as possible.</p>
        <fig id="pone-0017817-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0017817.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Plot of cost function for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e144" xlink:type="simple"/></inline-formula>.</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.g002" xlink:type="simple"/>
        </fig>
        <p>In the SA algorithm, we start at an initial ranking order. We then consider a “neighbor” ranking order, in which the ranks of two randomly selected macaques are switched. If the cost function decreases when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e145" xlink:type="simple"/></inline-formula> is modified by rearranging the rows and columns according to the neighbor ranking order, we move to the new ranking order. Otherwise, we move to the new ranking order with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e146" xlink:type="simple"/></inline-formula>. We compute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e147" xlink:type="simple"/></inline-formula> based on our progress in the SA algorithm, so that if we plan to complete <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e148" xlink:type="simple"/></inline-formula> iterations, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e149" xlink:type="simple"/></inline-formula> will decrease exponentially from nearly 1 to almost 0 as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e150" xlink:type="simple"/></inline-formula> approaches <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e151" xlink:type="simple"/></inline-formula>. In practice we use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e152" xlink:type="simple"/></inline-formula> and decrease <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e153" xlink:type="simple"/></inline-formula> only when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e154" xlink:type="simple"/></inline-formula> is a multiple of 10.</p>
        <p>After the last iteration we save the ranking order which produced the lowest cost encountered during the SA algorithm. The SA algorithm is designed so that it will tend to find the global minimum on a surface that may have multiple local minima. We run the SA algorithm many times and choose the best overall ranking order, i.e., that which corresponds to the rearrangement of rows and columns of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e155" xlink:type="simple"/></inline-formula> which yields the lowest cost. This order is taken as our estimate of the ranking of the mature rhesus macaques in a given enclosure.</p>
      </sec>
      <sec id="s2d">
        <title>The third step: S3</title>
        <p>The third step is used to construct a basis for empirical confidence intervals for desired features of the estimated ranking order obtained from step S2. For all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e156" xlink:type="simple"/></inline-formula> we randomly draw <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e157" xlink:type="simple"/></inline-formula> from the beta distribution with parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e158" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e159" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e160" xlink:type="simple"/></inline-formula> we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e161" xlink:type="simple"/></inline-formula>. Note that the mean of the given beta distribution is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e162" xlink:type="simple"/></inline-formula>. Hence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e163" xlink:type="simple"/></inline-formula> represents a random perturbation of the empirical dominance probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e164" xlink:type="simple"/></inline-formula> of macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e165" xlink:type="simple"/></inline-formula> over macaque <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e166" xlink:type="simple"/></inline-formula>. Once we obtain the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e167" xlink:type="simple"/></inline-formula> we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e168" xlink:type="simple"/></inline-formula> to convert the probability into odds, and thus construct the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e169" xlink:type="simple"/></inline-formula>. Using the transitivity structure matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e170" xlink:type="simple"/></inline-formula> constructed in step S1, which carries the transitivity structure that characterizes the real data, we construct the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e171" xlink:type="simple"/></inline-formula> by first setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e172" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e173" xlink:type="simple"/></inline-formula>, then setting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e174" xlink:type="simple"/></inline-formula> to standardize. We run step S2 on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e175" xlink:type="simple"/></inline-formula> to obtain an optimal ranking order <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e176" xlink:type="simple"/></inline-formula>. We then repeat with another draw from the beta distribution to obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e177" xlink:type="simple"/></inline-formula>, and so on to obtain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e178" xlink:type="simple"/></inline-formula> optimal ranking orders <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e179" xlink:type="simple"/></inline-formula>.</p>
        <p>We may then examine the distribution of the estimated rank for any individual macaque among the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e180" xlink:type="simple"/></inline-formula> ranking orders to derive confidence bounds for the rank estimate obtained in step S2. We can also derive bounds for the range of rankings corresponding to a specified matriline within the macaque society, or for other features of interest.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Female longhorn sheep</title>
        <p>A data set consisting of pairwise wins and losses within a group of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e181" xlink:type="simple"/></inline-formula> female longhorn sheep originally from <xref ref-type="bibr" rid="pone.0017817-Hass1">[5]</xref> was analyzed in <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref> using Bayesian analysis under the sequential ranking network framework. The matrix in <xref ref-type="table" rid="pone-0017817-t001">Table 1</xref>, reproduced from <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>, shows in entry <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e182" xlink:type="simple"/></inline-formula> the number of times sheep <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e183" xlink:type="simple"/></inline-formula> defeated sheep <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e184" xlink:type="simple"/></inline-formula> in confrontations. This matrix, arranged in ranking order, possesses several typical features of observational studies: few interactions for most pairs, and many pairs with no interactions. By assuming the existence of a sequential ranking hierarchy among the 20 female sheep, Bayesian analysis is conducted to estimate the twenty individual dominance potentials, say <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e185" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e186" xlink:type="simple"/></inline-formula>. The estimation is based on the likelihood constructed under an independence assumption among all pairs as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.e187" xlink:type="simple"/></disp-formula>where the logistic version of the Bradley–Terry model <xref ref-type="bibr" rid="pone.0017817-Bradley1">[13]</xref> sets <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e188" xlink:type="simple"/></inline-formula> as the kernel for transforming the difference between dominance potentials into a winning probability. The twenty-dimensional, mutually-independent normal flat priors of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e189" xlink:type="simple"/></inline-formula> are used. An estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e190" xlink:type="simple"/></inline-formula> is permuted and gives rise to a sequential ranking hierarchy.</p>
        <table-wrap id="pone-0017817-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0017817.t001</object-id><label>Table 1</label><caption>
            <title>Conflict data for female bighorn sheep.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0017817-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">ID</td>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">06</td>
                <td align="left" colspan="1" rowspan="1">08</td>
                <td align="left" colspan="1" rowspan="1">01</td>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">22</td>
                <td align="left" colspan="1" rowspan="1">02</td>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">05</td>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">09</td>
                <td align="left" colspan="1" rowspan="1">26</td>
                <td align="left" colspan="1" rowspan="1">25</td>
                <td align="left" colspan="1" rowspan="1">29</td>
                <td align="left" colspan="1" rowspan="1">27</td>
                <td align="left" colspan="1" rowspan="1">28</td>
                <td align="left" colspan="1" rowspan="1">24</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">5</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">06</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">08</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">01</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">22</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">02</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">4</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">05</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">2</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">09</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">26</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">25</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">29</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">27</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">28</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">3</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">24</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Matrix of wins and losses for 20 female bighorn sheep, <italic>Ovis canadensis</italic>, with rows and columns arranged according to estimated dominance rankings <xref ref-type="bibr" rid="pone.0017817-Hass1">[5]</xref>, <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>Unfortunately, the posterior density of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e191" xlink:type="simple"/></inline-formula> from this Bayesian analysis is just too flat to give rise to a meaningful sequential ranking hierarchy. In contrast, our three-step approach computes several zero-cost permutations among the 20 female sheep. The most obvious one is (15, 17, 21, 08, 06, 01, 10, 22, 02, 11, 16, 12, 05, 09, 26, 25, 29, 27, 28, 24), which pushes down the locations of sheep numbers 06 and 05 in the Adams result. Indeed, when the data are displayed according to this permutation, all but one entry in the lower-triangle of the matrix of <xref ref-type="table" rid="pone-0017817-t001">Table 1</xref> are zeros. When the estimated dominance probability matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e192" xlink:type="simple"/></inline-formula> is arranged in this order, no values in its lower triangle exceed 0.5, so that its cost is zero. Hence this computational result implies that the above permutation produces a perfect ranking order, while the Bayesian result is flawed.</p>
        <p>Typically a macaque conflict data set, as we will analyze in the next section, does not allow for such perfection when it comes to ranking. Usually there are many seemingly contradictory wins and losses that further complicate the task of ranking, particularly in species with frequent alliances and/or bidirectional aggression (see, e.g., <xref ref-type="bibr" rid="pone.0017817-Thierry1">[14]</xref>). However, such complexity is well-expected in a more sophisticated society. Hence it is deduced here that Bayesian analysis and the sequential ranking assumption are not suitable for a data set embedded with such kinds of complexity, especially when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e193" xlink:type="simple"/></inline-formula> is as large as 100.</p>
      </sec>
      <sec id="s3b">
        <title>Ranking network for rhesus macaques</title>
        <p>We apply our three steps to conflict data collected on two outdoor captive groups of rhesus macaques housed at the CNPRC. These behavioral data were collected between June 2008 and April 2009, and include all aggressive interactions that had a decisive outcome (for detailed methods, see <xref ref-type="bibr" rid="pone.0017817-Beisner1">[11]</xref>). For example, an interaction where an initiator threatens a recipient and the recipient runs away is counted as a win for the initiator and a loss for the recipient. Other aggressive behaviors include lunging, chasing, and biting. We apply steps S1 through S3 to these data. The first group (Cage 5) includes 94 adult rhesus macaques. <xref ref-type="fig" rid="pone-0017817-g003">Figure 3</xref> is a graphical representation of the optimal dominance probability matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0017817.e194" xlink:type="simple"/></inline-formula> returned by S2. A black square indicates a matrix entry whose value exceeds the threshold of 0.6, which we take to be a strong indicator of dominance. The cost of the corresponding optimal ranking network, using relation (1), is computed to be 55.02. It is noted that the cost for the initial ranking order used in step S2 was 205.62. Thus we see that the Simulated Annealing algorithm achieves a very significant improvement. From the ranking perspective, this network reveals a clear non-sequential structure. Although it does not look exactly like the matrix shown in <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(b)</xref>, there are many areas in the upper triangle of <xref ref-type="fig" rid="pone-0017817-g003">Figure 3</xref> that are rather sparse. Those sparse areas above the diagonal are likely to indicate parallel groups, while sparse triangular areas along the diagonal are rank-blurring groups. The latter groups' memberships are very essential for this non-sequential ranking network because they constitute the network's backbone structure.</p>
        <fig id="pone-0017817-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0017817.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Computed rhesus macaques' dominance probability matrix, with rows and columns arranged based on the optimal ranking order, for Cage 5.</title>
            <p>A black square indicates a computed dominance probability above 0.6.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.g003" xlink:type="simple"/>
        </fig>
        <p>Based upon the optimal ranking network, we list in <xref ref-type="table" rid="pone-0017817-t002">Table 2</xref> the rank coordinates computed for the members of each matriline in the macaque enclosure (Cage 5). Males are distinguished by bold italics. The most significant finding from this analysis is that the ranking network for this macaque society seems to have a “governing” group consisting of a dominant matriline (C7) subordinate only to a lone alpha male, and several additional elite individuals of either gender from several lower-ranking matrilines. This “power-sharing” structure seems to be very similar to human political systems. This sophisticated structure may be one of the key factors underlying the group's stability. Another significant finding, based on the sparse sections visible along the middle of the diagonal of <xref ref-type="fig" rid="pone-0017817-g003">Figure 3</xref>, is the existence of a subgroup of middle-ranking individuals who are somewhat parallel in dominance potential. These sparse sections correspond to the macaques between the 23rd and 50th ranks. Interestingly, this subgroup consists of a single middle-ranking matriline (F10), together with several individuals from other middle-ranking matrilines (D10, S16, J6, L4), as may be concluded from <xref ref-type="table" rid="pone-0017817-t002">Table 2</xref>. All these facts reveal the evident non-sequential structure in the ranking of the 94 individuals.</p>
        <table-wrap id="pone-0017817-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0017817.t002</object-id><label>Table 2</label><caption>
            <title>Cage 5 rankings by matriline.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0017817-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.t002" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Matriline</td>
                <td align="left" colspan="1" rowspan="1">Ranking coordinates</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">NRM</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>
                    <italic>1</italic>
                  </bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">C7</td>
                <td align="left" colspan="1" rowspan="1">3 4 <bold><italic>5</italic></bold> 6 7 8 9 10 12 14 <bold><italic>15</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">X1</td>
                <td align="left" colspan="1" rowspan="1">11 16 17 20 24 69 <bold><italic>89 92 94</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">S16</td>
                <td align="left" colspan="1" rowspan="1">18 <bold><italic>19</italic></bold> 21 22 23 <bold><italic>35 42</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">D10</td>
                <td align="left" colspan="1" rowspan="1">26 <bold><italic>34</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">J6</td>
                <td align="left" colspan="1" rowspan="1">25 29 31 36</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">L4</td>
                <td align="left" colspan="1" rowspan="1">30 33 <bold><italic>38</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">F10</td>
                <td align="left" colspan="1" rowspan="1">27 28 <bold><italic>37</italic></bold> 39 <bold><italic>40</italic></bold> 41 43 44 45 46 47 <bold><italic>48 49</italic></bold> 50 51 52 <bold><italic>84</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">N4</td>
                <td align="left" colspan="1" rowspan="1">32 <bold><italic>53</italic></bold> 54 55 56 57 58 59 60 <bold><italic>61</italic></bold> 63 <bold><italic>65</italic></bold> 68</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">M10</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>2</italic></bold> 62 64 <bold><italic>66 76 77</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Z2</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>13</italic></bold> 67 70 71 72 73 74 78 <bold><italic>79 80</italic></bold> 81 82 83 85 86</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">G8</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>75</italic></bold> 87 88 90 91 93</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>Summary of ranking coordinates for rhesus macaques in Cage 5 grouped according to matrilines. Males are indicated by bold italics.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>In terms of the corporate structure depicted in <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(a)</xref>, it appears that matriline C7 would correspond with group A at the top level, while matrilines X1, S16 and J6 would correspond with groups B, C and D on the second tier. Matrilines L10, D4 and F10 would share the third tier, corresponding to groups E, F and G. Matrilines N4, M10 and Z2 would comprise a fourth tier that has no counterpart in <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(a)</xref>, while matriline G8 occupies the bottom level, corresponding to group H.</p>
        <p>Based on our output from step S3, which involved 105 iterations, we may infer confidence bounds for the ranking of each macaque. <xref ref-type="fig" rid="pone-0017817-g004">Figure 4</xref> displays boxplots for the top 20 macaques based on the optimal ranking determined by step S2 (indicated by open circles in the figure). Each boxplot indicates the distribution of computed rankings for each of these macaques over the 105 iterations. Points above or below the whiskers of a boxplot are outliers. A short box suggests that the corresponding macaque's rank is fairly consistent over the 105 iterations, as is the case with the alpha male (ID 24926). Hence the rank of such individuals is fairly certain. A long box suggests that the corresponding macaque's estimated rank is quite uncertain, given the data, as with the beta male (ID 22898). Moving this macaque's position in the ranking order does not affect the cost significantly. Since there are few such individuals in this example, the variability of their rankings over the 105 iterations has only a slight impact on the variability of the rankings for their neighbors in the hierarchy.</p>
        <fig id="pone-0017817-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0017817.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Boxplots indicating confidence bounds for top twenty rhesus macaques, based on optimal ranking order computed in step S2 and 105 iterations of step S3 for macaques in Cage 5.</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.g004" xlink:type="simple"/>
        </fig>
        <p>We might also take interest in the range of ranks for a group of macaques, such as for a particular matriline. Our step S2 estimated the ranks for the eleven macaques in the C7 matriline to fall between 3 and 15 inclusive, making this the highest-ranking matriline in the society. Using the output of step S3, we find that the highest rank assigned among the members of C7 was distributed as follows: 1 (one time), 2 (88 times) and 3 (16 times). Meanwhile, the lowest rank among the C7 macaques was distributed more widely:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.e195" xlink:type="simple"/></disp-formula>The range between the highest and lowest ranks was centered at 14. To obtain empirical 95% confidence bounds, we eliminate the 5 most extreme values from each distribution, and conclude with 95% confidence that the highest rank for matriline C7 is between 2 and 3, while its lowest rank is between 13 and 22. This gives strong evidence that this matriline dominates the others.</p>
        <p>We implement the same procedure for a second macaque colony living in a separate enclosure (Cage 8) at the CNPRC. We initially identify 136 adults in the colony. However, only 91 of these adults were involved in observed conflicts during the period of interest, so the other 45 adults were removed from consideration. The value of the cost function (1) for the optimal ranking network for these macaques, based on the output of step S2, was 49.59. Once again, a lone male is identified at the top of the hierarchy, followed by a dominant matriline (C16). The remaining matrilines follow in succession, with several matrilines having an elite member of either gender whose rank is very high compared to the rest of the matriline. The ranks are arranged by matriline in <xref ref-type="table" rid="pone-0017817-t003">Table 3</xref>, with males indicated by bold italics. In terms of <xref ref-type="fig" rid="pone-0017817-g001">Figure 1(a)</xref>, we do not find quite the same multi-tiered structure. It is likely matrilines G11, Q3 and D13 occupy the same tier, as do matrilines N8 and N6, while the other matrilines occupy tiers by themselves. Since the analysis of the second colony identifies a similar network structure, our confidence in the consistency of this three-step approach is strongly validated. Our analysis of several additional colonies yield comparable results.</p>
        <table-wrap id="pone-0017817-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0017817.t003</object-id><label>Table 3</label><caption>
            <title>Cage 8 rankings by matriline.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pone-0017817-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0017817.t003" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">Matriline</td>
                <td align="left" colspan="1" rowspan="1">Ranking coordinates</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">S22</td>
                <td align="left" colspan="1" rowspan="1">
                  <bold>
                    <italic>1</italic>
                  </bold>
                </td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">C16</td>
                <td align="left" colspan="1" rowspan="1">2 3 6 7 8 9 10 <bold><italic>13</italic></bold> 14</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">F13</td>
                <td align="left" colspan="1" rowspan="1">4 11 15 16 17 18 19 20 21 22 23 <bold><italic>43 87</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">V5</td>
                <td align="left" colspan="1" rowspan="1">24 25 26 27 28 29 30 31 34 35 <bold><italic>90</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">L8</td>
                <td align="left" colspan="1" rowspan="1">36 37 38</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">K8</td>
                <td align="left" colspan="1" rowspan="1">12 39 40 41 42 44 45 46 47 49 52 69 <bold><italic>86 91</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">D13</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>5</italic></bold> 48 54</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">G11</td>
                <td align="left" colspan="1" rowspan="1">51 55 58 <bold><italic>59</italic></bold> 60 61 64 <bold><italic>89</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">Q3</td>
                <td align="left" colspan="1" rowspan="1">50 53 56 57 63 85 <bold><italic>88</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">T9</td>
                <td align="left" colspan="1" rowspan="1">65 66</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">B12</td>
                <td align="left" colspan="1" rowspan="1">67 68 70 71 72 <bold><italic>81</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">M14</td>
                <td align="left" colspan="1" rowspan="1">32 73</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">N8</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>62</italic></bold> 74 75 77 78 <bold><italic>79</italic></bold></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">N6</td>
                <td align="left" colspan="1" rowspan="1"><bold><italic>33</italic></bold> 76 80</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">P11</td>
                <td align="left" colspan="1" rowspan="1">82 83 84</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt103">
              <label/>
              <p>Summary of ranking coordinates for rhesus macaques in Cage 8 grouped according to matrilines. Males are indicated by bold italics.</p>
            </fn>
          </table-wrap-foot></table-wrap>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>We propose a three-step approach to compute and construct a non-sequential ranking network based on highly heterogeneous counts of aggressive interactions among mature members of a society of rhesus macaques. We provide theoretical arguments and explicit reasoning that describe the challenging nature of this task. We propose a set of three steps, each of which is designed to resolve a significant challenge encountered in the construction of real-world ranking networks. However, our solution to this computational challenge sheds light on how the underlying corporative kingdom structure of rhesus macaque society influences the behavior of individuals as well as the stability of the society as a whole. We expect that this new approach will be useful in many other studies, especially when dealing with the property of transitivity among binary relational data. From this perspective, corporative network theory may still be in its infancy.</p>
      <p>Finally, we briefly comment on the limits of the maximum likelihood estimate (MLE) approach and Bayesian analysis in constructing corporative ranking networks. The transitivity-induced parameter dependence makes the pertinent parameter space a complex manifold. This manifold structure is problematic for the optimization procedures of the MLE and the assignment of reliable prior distributions in Bayesian analysis. In particular, Bayesian analysis always produces a very flat posterior density when employing a non-informative prior on even a modest number of parameters. In addition, the high dimensionality of this manifold structure further complicates the situation, if not rendering it impossible to resolve. For example, it is common practice among animal behaviorists to impose a sequential ranking assumption on the structure of animal societies <xref ref-type="bibr" rid="pone.0017817-Adams1">[6]</xref>. However, the imposition of a sequential rank order ignores the aforementioned difficulties. Indeed, an assumption of a sequential structure implies transitivity, which further necessitates dependence among the parameters, resulting in such difficulties. Therefore, it is our hope that the three steps developed here will be broadly applicable to the study of ranking network structures of many societies.</p>
      <p>This three-step approach is an advancement in the challenging task of computing rank coordinates in societies which do not possess a sequential hierarchy. By incorporating information gained through dominance transitivity, we accommodate apparently contradictory cycles in the data to obtain reasonable estimates of pairwise dominance probabilities. We also acknowledge the uncertainty in the data and exploit it so as to provide reasonable confidence bounds for the ranks of individuals. While other mathematical methods assume a sequential ranking order for all members of an animal society, our approach provides more flexibility, in that the computed result allows for some variability in the estimated ranking coordinates. This is because the assigned ranks for some individuals may be interchanged without affecting the value of the cost function.</p>
      <p>For societies like the rhesus macaques, this flexibility in our approach is essential. The scientists who observe the macaque societies at the CNPRC are in agreement that their hierarchies are not sequential. The relative ranks of matrilines can be identified by observation, but the ranks of individuals within the matrilines are more difficult to identify, partly because the groups are very large, and partly because some matrilines are genetically fragmented. Hence, while the imposition of an assumption that the hierarchy is sequential is necessary under other accepted ranking methods, it is artificial, and the output from such methods generally conflicts with the observations of researchers. A method based on a corporative kingdom model, as presented here, is coherent with these observations, and is therefore a more realistic tool for the analysis of rhesus macaque ranking networks.</p>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors gratefully acknowledge the contributions of Megan Jackson, Shannon Seil, Ashley Cameron, Allison Heagerty and Christopher Dienes.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0017817-Drews1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Drews</surname><given-names>C</given-names></name></person-group>             <year>1992</year>             <article-title>The concept and definition of dominance in animal behavior.</article-title>             <source>Behaviour</source>             <volume>125</volume>             <fpage>283</fpage>             <lpage>313</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Bonabeau1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bonabeau</surname><given-names>E</given-names></name><name name-style="western"><surname>Theraulaz</surname><given-names>Z</given-names></name><name name-style="western"><surname>Deneubourg</surname><given-names>JL</given-names></name></person-group>             <year>1996</year>             <article-title>Mathematical model of self-organizing hierarchies in animal societies.</article-title>             <source>Bulletin of Mathematical Biology</source>             <volume>58</volume>             <fpage>661</fpage>             <lpage>717</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Goessmann1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Goessmann</surname><given-names>C</given-names></name><name name-style="western"><surname>Hemelrijk</surname><given-names>C</given-names></name><name name-style="western"><surname>Huber</surname><given-names>R</given-names></name></person-group>             <year>2000</year>             <article-title>The formation and maintenance of crayfish hierarchies: behavioral and self-structuring properties.</article-title>             <source>Behavioral Ecology and Sociobiology</source>             <volume>48</volume>             <fpage>418</fpage>             <lpage>428</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Nagy1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nagy</surname><given-names>M</given-names></name><name name-style="western"><surname>Ákos</surname><given-names>Z</given-names></name><name name-style="western"><surname>Biro</surname><given-names>D</given-names></name><name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name></person-group>             <year>2010</year>             <article-title>Hierarchical group dynamics in pigeon ocks.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>890</fpage>             <lpage>893</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Hass1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hass</surname><given-names>C</given-names></name></person-group>             <year>1991</year>             <article-title>Social status in female longhorn sheep (<italic>Ovis canadaensis</italic>): expression, development and reproductive correlates.</article-title>             <source>J of Zoology</source>             <volume>225</volume>             <fpage>509</fpage>             <lpage>523</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Adams1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>E</given-names></name></person-group>             <year>2006</year>             <article-title>Bayesian analysis of linear dominance hierarchies.</article-title>             <source>Animal Behaviour</source>             <volume>69</volume>             <fpage>1191</fpage>             <lpage>1201</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Isbell1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Isbell</surname><given-names>L</given-names></name></person-group>             <year>2002</year>             <article-title>Ecological models of female social relationships in primates: similarities, disparities and some directions for future clarity.</article-title>             <source>Behaviour</source>             <volume>139</volume>             <fpage>177</fpage>             <lpage>202</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Hemelrijk1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hemelrijk</surname><given-names>C</given-names></name><name name-style="western"><surname>Wantia</surname><given-names>J</given-names></name><name name-style="western"><surname>Gygax</surname><given-names>L</given-names></name></person-group>             <year>2005</year>             <article-title>The construction of dominance order: comparing performance of five methods using an individual-based model.</article-title>             <source>Behaviour</source>             <volume>142</volume>             <fpage>1037</fpage>             <lpage>1058</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-DeVries1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>De Vries</surname><given-names>H</given-names></name></person-group>             <year>1998</year>             <article-title>Finding a dominance order most consistent with a linear hierarchy: a new procedure and review.</article-title>             <source>Animal Behaviour</source>             <volume>55</volume>             <fpage>827</fpage>             <lpage>843</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Wasserman1">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wasserman</surname><given-names>S</given-names></name><name name-style="western"><surname>Faust</surname><given-names>K</given-names></name></person-group>             <year>1994</year>             <source>Social Network Analysis</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pone.0017817-Beisner1">
        <label>11</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Beisner</surname><given-names>B</given-names></name><name name-style="western"><surname>Jackson</surname><given-names>M</given-names></name><name name-style="western"><surname>Cameron</surname><given-names>A</given-names></name><name name-style="western"><surname>McCowan</surname><given-names>B</given-names></name></person-group>             <year>2010</year>             <article-title>Effects of natal male alliances on aggression and power dynamics in rhesus macaques.</article-title>             <source>American Journal of Primatology</source>             <comment>In press</comment>          </element-citation>
      </ref>
      <ref id="pone.0017817-Kirkpatrick1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kirkpatrick</surname><given-names>S</given-names></name><name name-style="western"><surname>Gelatt</surname><given-names>C</given-names></name><name name-style="western"><surname>Vecchi</surname><given-names>M</given-names></name></person-group>             <year>1983</year>             <article-title>Optimization by Simulated Annealing.</article-title>             <source>Science, New Series</source>             <volume>220</volume>             <fpage>671</fpage>             <lpage>680</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Bradley1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bradley</surname><given-names>R</given-names></name><name name-style="western"><surname>Terry</surname><given-names>M</given-names></name></person-group>             <year>1952</year>             <article-title>Rank analysis of incomplete block designs. I. The method of paired comparison.</article-title>             <source>Biometrika</source>             <volume>39</volume>             <fpage>324</fpage>             <lpage>345</lpage>          </element-citation>
      </ref>
      <ref id="pone.0017817-Thierry1">
        <label>14</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="editor"><name name-style="western"><surname>Thierry</surname><given-names>B</given-names></name><name name-style="western"><surname>Singh</surname><given-names>M</given-names></name><name name-style="western"><surname>Kaumanns</surname><given-names>W</given-names></name></person-group>             <year>2004</year>             <source>Social epigenesis</source>             <publisher-loc>Cambridge</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>